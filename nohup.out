2023-05-03 21:26:55.458188: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-03 21:26:56.054103: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/amazon/efa/lib:/opt/amazon/openmpi/lib:/usr/local/cuda/efa/lib:/usr/local/cuda/lib:/usr/local/cuda:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda/targets/x86_64-linux/lib:/usr/local/lib:/usr/lib:/opt/amazon/efa/lib:/opt/amazon/openmpi/lib:/usr/local/cuda/efa/lib:/usr/local/cuda/lib:/usr/local/cuda:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda/targets/x86_64-linux/lib:/usr/local/lib:/usr/lib:
2023-05-03 21:26:56.054275: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: /opt/amazon/efa/lib:/opt/amazon/openmpi/lib:/usr/local/cuda/efa/lib:/usr/local/cuda/lib:/usr/local/cuda:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda/targets/x86_64-linux/lib:/usr/local/lib:/usr/lib:/opt/amazon/efa/lib:/opt/amazon/openmpi/lib:/usr/local/cuda/efa/lib:/usr/local/cuda/lib:/usr/local/cuda:/usr/local/cuda/lib64:/usr/local/cuda/extras/CUPTI/lib64:/usr/local/cuda/targets/x86_64-linux/lib:/usr/local/lib:/usr/lib:
2023-05-03 21:26:56.054333: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
/home/ubuntu/.local/lib/python3.9/site-packages/tensorflow_addons/utils/tfa_eol_msg.py:23: UserWarning: 

TensorFlow Addons (TFA) has ended development and introduction of new features.
TFA has entered a minimal maintenance and release mode until a planned end of life in May 2024.
Please modify downstream libraries to take dependencies from other repositories in our TensorFlow community (e.g. Keras, Keras-CV, and Keras-NLP). 

For more information see: https://github.com/tensorflow/addons/issues/2807 

  warnings.warn(
[PhysicalDevice(name='/physical_device:CPU:0', device_type='CPU'), PhysicalDevice(name='/physical_device:GPU:0', device_type='GPU')]
Reading users_pu5
Reading items_pu5
Reading purchases_txt_pu5
Reading items_sorted_pu5
Reading users_sorted_pu5
Read all in 0.7613799571990967
Tokenizer trained for 19908 items.
Creating 1 splits of 10000 samples each.
Creating split nr. 1
SplitGenerator init done in 4.187239646911621 secs.
SplitGenerator init done in 0.513157844543457 secs.
SplitGenerator init done in 0.5147526264190674 secs.
Creating evaluator
Creating test split evaluator with leave_random_20_pct_out method.
Creating validation split evaluator with leave_random_20_pct_out method.
================================================================================
Train for 50 epochs with lr 0.00005
Epoch 1/5
WARNING:tensorflow:From /home/ubuntu/.local/lib/python3.9/site-packages/tensorflow/python/autograph/pyct/static_analysis/liveness.py:83: Analyzer.lamba_check (from tensorflow.python.autograph.pyct.static_analysis.liveness) is deprecated and will be removed after 2023-09-23.
Instructions for updating:
Lambda fuctions will be no more assumed to be used in the statement where they are used, or at least in the same block. https://github.com/tensorflow/tensorflow/issues/56089
  1/105 [..............................] - ETA: 23:46 - loss: 66.3637 - mse: 0.0100 - cosine_loss: 0.9245 - kl_div: 1.1462  2/105 [..............................] - ETA: 15s - loss: 67.2110 - mse: 0.0101 - cosine_loss: 0.9219 - kl_div: 1.1374    3/105 [..............................] - ETA: 22s - loss: 65.6770 - mse: 0.0099 - cosine_loss: 0.9208 - kl_div: 1.1310  4/105 [>.............................] - ETA: 25s - loss: 64.7277 - mse: 0.0099 - cosine_loss: 0.9184 - kl_div: 1.1254  5/105 [>.............................] - ETA: 26s - loss: 63.3377 - mse: 0.0097 - cosine_loss: 0.9167 - kl_div: 1.1208  6/105 [>.............................] - ETA: 26s - loss: 62.6714 - mse: 0.0097 - cosine_loss: 0.9139 - kl_div: 1.1173  7/105 [=>............................] - ETA: 27s - loss: 62.2941 - mse: 0.0096 - cosine_loss: 0.9108 - kl_div: 1.1150  8/105 [=>............................] - ETA: 27s - loss: 61.6986 - mse: 0.0095 - cosine_loss: 0.9072 - kl_div: 1.1142  9/105 [=>............................] - ETA: 27s - loss: 60.6840 - mse: 0.0093 - cosine_loss: 0.9031 - kl_div: 1.1154 10/105 [=>............................] - ETA: 27s - loss: 59.3308 - mse: 0.0091 - cosine_loss: 0.8989 - kl_div: 1.1182 11/105 [==>...........................] - ETA: 27s - loss: 58.4258 - mse: 0.0090 - cosine_loss: 0.8937 - kl_div: 1.1234 12/105 [==>...........................] - ETA: 26s - loss: 56.9801 - mse: 0.0088 - cosine_loss: 0.8886 - kl_div: 1.1307 13/105 [==>...........................] - ETA: 26s - loss: 55.7482 - mse: 0.0086 - cosine_loss: 0.8836 - kl_div: 1.1392 14/105 [===>..........................] - ETA: 26s - loss: 54.5511 - mse: 0.0084 - cosine_loss: 0.8784 - kl_div: 1.1494 15/105 [===>..........................] - ETA: 26s - loss: 53.4910 - mse: 0.0082 - cosine_loss: 0.8734 - kl_div: 1.1603 16/105 [===>..........................] - ETA: 25s - loss: 52.5060 - mse: 0.0080 - cosine_loss: 0.8686 - kl_div: 1.1723 17/105 [===>..........................] - ETA: 25s - loss: 51.7847 - mse: 0.0078 - cosine_loss: 0.8639 - kl_div: 1.1851 18/105 [====>.........................] - ETA: 25s - loss: 51.1707 - mse: 0.0077 - cosine_loss: 0.8594 - kl_div: 1.1979 19/105 [====>.........................] - ETA: 25s - loss: 50.4900 - mse: 0.0076 - cosine_loss: 0.8553 - kl_div: 1.2108 20/105 [====>.........................] - ETA: 25s - loss: 49.9382 - mse: 0.0074 - cosine_loss: 0.8518 - kl_div: 1.2227 21/105 [=====>........................] - ETA: 24s - loss: 49.4113 - mse: 0.0073 - cosine_loss: 0.8485 - kl_div: 1.2344 22/105 [=====>........................] - ETA: 24s - loss: 48.9658 - mse: 0.0072 - cosine_loss: 0.8451 - kl_div: 1.2457 23/105 [=====>........................] - ETA: 24s - loss: 48.3935 - mse: 0.0071 - cosine_loss: 0.8422 - kl_div: 1.2563 24/105 [=====>........................] - ETA: 24s - loss: 47.7563 - mse: 0.0070 - cosine_loss: 0.8397 - kl_div: 1.2657 25/105 [======>.......................] - ETA: 23s - loss: 47.0933 - mse: 0.0069 - cosine_loss: 0.8374 - kl_div: 1.2745 26/105 [======>.......................] - ETA: 23s - loss: 46.4682 - mse: 0.0068 - cosine_loss: 0.8352 - kl_div: 1.2827 27/105 [======>.......................] - ETA: 23s - loss: 45.9841 - mse: 0.0067 - cosine_loss: 0.8331 - kl_div: 1.2900 28/105 [=======>......................] - ETA: 22s - loss: 45.5748 - mse: 0.0067 - cosine_loss: 0.8310 - kl_div: 1.2968 29/105 [=======>......................] - ETA: 22s - loss: 45.1214 - mse: 0.0066 - cosine_loss: 0.8288 - kl_div: 1.3035 30/105 [=======>......................] - ETA: 22s - loss: 44.6244 - mse: 0.0065 - cosine_loss: 0.8268 - kl_div: 1.3090 31/105 [=======>......................] - ETA: 22s - loss: 44.1369 - mse: 0.0065 - cosine_loss: 0.8250 - kl_div: 1.3139 32/105 [========>.....................] - ETA: 21s - loss: 43.8637 - mse: 0.0064 - cosine_loss: 0.8231 - kl_div: 1.3183 33/105 [========>.....................] - ETA: 21s - loss: 43.6461 - mse: 0.0063 - cosine_loss: 0.8212 - kl_div: 1.3220 34/105 [========>.....................] - ETA: 21s - loss: 43.2101 - mse: 0.0063 - cosine_loss: 0.8196 - kl_div: 1.3250 35/105 [=========>....................] - ETA: 20s - loss: 42.8238 - mse: 0.0062 - cosine_loss: 0.8181 - kl_div: 1.3275 36/105 [=========>....................] - ETA: 20s - loss: 42.5099 - mse: 0.0062 - cosine_loss: 0.8164 - kl_div: 1.3298 37/105 [=========>....................] - ETA: 20s - loss: 42.2483 - mse: 0.0061 - cosine_loss: 0.8147 - kl_div: 1.3317 38/105 [=========>....................] - ETA: 19s - loss: 41.9045 - mse: 0.0061 - cosine_loss: 0.8132 - kl_div: 1.3330 39/105 [==========>...................] - ETA: 19s - loss: 41.6278 - mse: 0.0060 - cosine_loss: 0.8115 - kl_div: 1.3342 40/105 [==========>...................] - ETA: 19s - loss: 41.3137 - mse: 0.0060 - cosine_loss: 0.8100 - kl_div: 1.3348 41/105 [==========>...................] - ETA: 19s - loss: 41.0486 - mse: 0.0060 - cosine_loss: 0.8084 - kl_div: 1.3354 42/105 [===========>..................] - ETA: 18s - loss: 40.8032 - mse: 0.0059 - cosine_loss: 0.8067 - kl_div: 1.3357 43/105 [===========>..................] - ETA: 18s - loss: 40.5336 - mse: 0.0059 - cosine_loss: 0.8052 - kl_div: 1.3358 44/105 [===========>..................] - ETA: 18s - loss: 40.2896 - mse: 0.0058 - cosine_loss: 0.8036 - kl_div: 1.3357 45/105 [===========>..................] - ETA: 17s - loss: 40.0242 - mse: 0.0058 - cosine_loss: 0.8021 - kl_div: 1.3353 46/105 [============>.................] - ETA: 17s - loss: 39.7605 - mse: 0.0058 - cosine_loss: 0.8006 - kl_div: 1.3347 47/105 [============>.................] - ETA: 17s - loss: 39.5854 - mse: 0.0057 - cosine_loss: 0.7990 - kl_div: 1.3339 48/105 [============>.................] - ETA: 17s - loss: 39.2851 - mse: 0.0057 - cosine_loss: 0.7976 - kl_div: 1.3330 49/105 [=============>................] - ETA: 16s - loss: 39.1042 - mse: 0.0057 - cosine_loss: 0.7961 - kl_div: 1.3319 50/105 [=============>................] - ETA: 16s - loss: 38.9487 - mse: 0.0056 - cosine_loss: 0.7946 - kl_div: 1.3307 51/105 [=============>................] - ETA: 16s - loss: 38.7472 - mse: 0.0056 - cosine_loss: 0.7933 - kl_div: 1.3292 52/105 [=============>................] - ETA: 15s - loss: 38.4884 - mse: 0.0056 - cosine_loss: 0.7920 - kl_div: 1.3276 53/105 [==============>...............] - ETA: 15s - loss: 38.2913 - mse: 0.0055 - cosine_loss: 0.7906 - kl_div: 1.3259 54/105 [==============>...............] - ETA: 15s - loss: 38.1065 - mse: 0.0055 - cosine_loss: 0.7893 - kl_div: 1.3241 55/105 [==============>...............] - ETA: 15s - loss: 37.8897 - mse: 0.0055 - cosine_loss: 0.7878 - kl_div: 1.3223 56/105 [===============>..............] - ETA: 14s - loss: 37.6843 - mse: 0.0055 - cosine_loss: 0.7865 - kl_div: 1.3203 57/105 [===============>..............] - ETA: 14s - loss: 37.4913 - mse: 0.0054 - cosine_loss: 0.7852 - kl_div: 1.3183 58/105 [===============>..............] - ETA: 14s - loss: 37.2910 - mse: 0.0054 - cosine_loss: 0.7840 - kl_div: 1.3161 59/105 [===============>..............] - ETA: 13s - loss: 37.1662 - mse: 0.0054 - cosine_loss: 0.7827 - kl_div: 1.3139 60/105 [================>.............] - ETA: 13s - loss: 36.9997 - mse: 0.0054 - cosine_loss: 0.7814 - kl_div: 1.3117 61/105 [================>.............] - ETA: 13s - loss: 36.8183 - mse: 0.0053 - cosine_loss: 0.7801 - kl_div: 1.3093 62/105 [================>.............] - ETA: 12s - loss: 36.6205 - mse: 0.0053 - cosine_loss: 0.7788 - kl_div: 1.3069 63/105 [=================>............] - ETA: 12s - loss: 36.4179 - mse: 0.0053 - cosine_loss: 0.7776 - kl_div: 1.3045 64/105 [=================>............] - ETA: 12s - loss: 36.2612 - mse: 0.0053 - cosine_loss: 0.7764 - kl_div: 1.3020 65/105 [=================>............] - ETA: 12s - loss: 36.0908 - mse: 0.0052 - cosine_loss: 0.7752 - kl_div: 1.2995 66/105 [=================>............] - ETA: 11s - loss: 35.9441 - mse: 0.0052 - cosine_loss: 0.7740 - kl_div: 1.2969 67/105 [==================>...........] - ETA: 11s - loss: 35.8043 - mse: 0.0052 - cosine_loss: 0.7726 - kl_div: 1.2944 68/105 [==================>...........] - ETA: 11s - loss: 35.6585 - mse: 0.0052 - cosine_loss: 0.7715 - kl_div: 1.2918 69/105 [==================>...........] - ETA: 10s - loss: 35.4864 - mse: 0.0051 - cosine_loss: 0.7702 - kl_div: 1.2892 70/105 [===================>..........] - ETA: 10s - loss: 35.3917 - mse: 0.0051 - cosine_loss: 0.7691 - kl_div: 1.2867 71/105 [===================>..........] - ETA: 10s - loss: 35.3000 - mse: 0.0051 - cosine_loss: 0.7678 - kl_div: 1.2842 72/105 [===================>..........] - ETA: 9s - loss: 35.1715 - mse: 0.0051 - cosine_loss: 0.7667 - kl_div: 1.2816  73/105 [===================>..........] - ETA: 9s - loss: 35.0761 - mse: 0.0051 - cosine_loss: 0.7654 - kl_div: 1.2791 74/105 [====================>.........] - ETA: 9s - loss: 34.9492 - mse: 0.0051 - cosine_loss: 0.7643 - kl_div: 1.2766 75/105 [====================>.........] - ETA: 9s - loss: 34.7909 - mse: 0.0050 - cosine_loss: 0.7632 - kl_div: 1.2740 76/105 [====================>.........] - ETA: 8s - loss: 34.6592 - mse: 0.0050 - cosine_loss: 0.7621 - kl_div: 1.2716 77/105 [=====================>........] - ETA: 8s - loss: 34.5008 - mse: 0.0050 - cosine_loss: 0.7610 - kl_div: 1.2691 78/105 [=====================>........] - ETA: 8s - loss: 34.3646 - mse: 0.0050 - cosine_loss: 0.7598 - kl_div: 1.2667 79/105 [=====================>........] - ETA: 7s - loss: 34.2480 - mse: 0.0050 - cosine_loss: 0.7587 - kl_div: 1.2642 80/105 [=====================>........] - ETA: 7s - loss: 34.1264 - mse: 0.0050 - cosine_loss: 0.7576 - kl_div: 1.2618 81/105 [======================>.......] - ETA: 7s - loss: 34.0257 - mse: 0.0049 - cosine_loss: 0.7565 - kl_div: 1.2594 82/105 [======================>.......] - ETA: 6s - loss: 33.9271 - mse: 0.0049 - cosine_loss: 0.7554 - kl_div: 1.2571 83/105 [======================>.......] - ETA: 6s - loss: 33.7873 - mse: 0.0049 - cosine_loss: 0.7544 - kl_div: 1.2547 84/105 [=======================>......] - ETA: 6s - loss: 33.6945 - mse: 0.0049 - cosine_loss: 0.7533 - kl_div: 1.2525 85/105 [=======================>......] - ETA: 6s - loss: 33.6199 - mse: 0.0049 - cosine_loss: 0.7523 - kl_div: 1.2502 86/105 [=======================>......] - ETA: 5s - loss: 33.5288 - mse: 0.0049 - cosine_loss: 0.7512 - kl_div: 1.2480 87/105 [=======================>......] - ETA: 5s - loss: 33.4345 - mse: 0.0048 - cosine_loss: 0.7502 - kl_div: 1.2458 88/105 [========================>.....] - ETA: 5s - loss: 33.3322 - mse: 0.0048 - cosine_loss: 0.7492 - kl_div: 1.2437 89/105 [========================>.....] - ETA: 4s - loss: 33.2832 - mse: 0.0048 - cosine_loss: 0.7481 - kl_div: 1.2416 90/105 [========================>.....] - ETA: 4s - loss: 33.1689 - mse: 0.0048 - cosine_loss: 0.7470 - kl_div: 1.2395 91/105 [=========================>....] - ETA: 4s - loss: 33.1138 - mse: 0.0048 - cosine_loss: 0.7460 - kl_div: 1.2374 92/105 [=========================>....] - ETA: 3s - loss: 33.0322 - mse: 0.0048 - cosine_loss: 0.7449 - kl_div: 1.2354 93/105 [=========================>....] - ETA: 3s - loss: 32.9519 - mse: 0.0048 - cosine_loss: 0.7440 - kl_div: 1.2334 94/105 [=========================>....] - ETA: 3s - loss: 32.8615 - mse: 0.0047 - cosine_loss: 0.7429 - kl_div: 1.2315 95/105 [==========================>...] - ETA: 3s - loss: 32.7705 - mse: 0.0047 - cosine_loss: 0.7420 - kl_div: 1.2295 96/105 [==========================>...] - ETA: 2s - loss: 32.6894 - mse: 0.0047 - cosine_loss: 0.7409 - kl_div: 1.2276 97/105 [==========================>...] - ETA: 2s - loss: 32.5947 - mse: 0.0047 - cosine_loss: 0.7400 - kl_div: 1.2257 98/105 [===========================>..] - ETA: 2s - loss: 32.5093 - mse: 0.0047 - cosine_loss: 0.7389 - kl_div: 1.2239 99/105 [===========================>..] - ETA: 1s - loss: 32.4419 - mse: 0.0047 - cosine_loss: 0.7380 - kl_div: 1.2221100/105 [===========================>..] - ETA: 1s - loss: 32.3757 - mse: 0.0047 - cosine_loss: 0.7370 - kl_div: 1.2204101/105 [===========================>..] - ETA: 1s - loss: 32.2858 - mse: 0.0047 - cosine_loss: 0.7361 - kl_div: 1.2186102/105 [============================>.] - ETA: 0s - loss: 32.1911 - mse: 0.0047 - cosine_loss: 0.7351 - kl_div: 1.2168103/105 [============================>.] - ETA: 0s - loss: 32.1265 - mse: 0.0046 - cosine_loss: 0.7341 - kl_div: 1.2151104/105 [============================>.] - ETA: 0s - loss: 32.0626 - mse: 0.0046 - cosine_loss: 0.7331 - kl_div: 1.2135105/105 [==============================] - ETA: 0s - loss: 31.9630 - mse: 0.0046 - cosine_loss: 0.7322 - kl_div: 1.2117 1/36 [..............................] - ETA: 14s13/36 [=========>....................] - ETA: 0s 25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 1s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s27/36 [=====================>........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s27/36 [=====================>........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s27/36 [=====================>........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s27/36 [=====================>........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
2023-05-03 21:29:15.898590: W tensorflow/tsl/framework/cpu_allocator_impl.cc:82] Allocation of 6457589760 exceeds 10% of free system memory.
2023-05-03 21:29:23.942286: W tensorflow/tsl/framework/cpu_allocator_impl.cc:82] Allocation of 6457589760 exceeds 10% of free system memory.
2023-05-03 21:29:25.390335: W tensorflow/tsl/framework/cpu_allocator_impl.cc:82] Allocation of 10356422640 exceeds 10% of free system memory.
Model metrics:Recall@5=0.2437 Recall@20=0.3014 custom_Recall@20=0.2723 Recall@50=0.4164 custom_Recall@50=0.4113 NCDG@100=0.3343 custom_NCDG@100=0.3343 Coverage@5=0.0619 Coverage@20=0.112 Coverage@50=0.166 Coverage@100=0.2224 
New best for NCDG@100
New best for Recall@20
New best for Recall@50
105/105 [==============================] - 137s 1s/step - loss: 31.9630 - mse: 0.0046 - cosine_loss: 0.7322 - kl_div: 1.2117 - val_loss: 22.0702 - val_mse: 0.0033 - val_cosine_loss: 0.6106 - val_kl_div: 0.0000e+00
Epoch 2/5
  1/105 [..............................] - ETA: 47s - loss: 21.8568 - mse: 0.0032 - cosine_loss: 0.6268 - kl_div: 1.0395  2/105 [..............................] - ETA: 32s - loss: 24.1330 - mse: 0.0035 - cosine_loss: 0.6317 - kl_div: 1.0400  3/105 [..............................] - ETA: 31s - loss: 24.0885 - mse: 0.0034 - cosine_loss: 0.6274 - kl_div: 1.0404  4/105 [>.............................] - ETA: 31s - loss: 23.7436 - mse: 0.0035 - cosine_loss: 0.6271 - kl_div: 1.0393  5/105 [>.............................] - ETA: 30s - loss: 23.6292 - mse: 0.0034 - cosine_loss: 0.6250 - kl_div: 1.0391  6/105 [>.............................] - ETA: 30s - loss: 23.6259 - mse: 0.0034 - cosine_loss: 0.6258 - kl_div: 1.0372  7/105 [=>............................] - ETA: 29s - loss: 23.2917 - mse: 0.0034 - cosine_loss: 0.6245 - kl_div: 1.0368  8/105 [=>............................] - ETA: 29s - loss: 23.2850 - mse: 0.0034 - cosine_loss: 0.6241 - kl_div: 1.0364  9/105 [=>............................] - ETA: 29s - loss: 23.1417 - mse: 0.0034 - cosine_loss: 0.6239 - kl_div: 1.0359 10/105 [=>............................] - ETA: 28s - loss: 22.9903 - mse: 0.0034 - cosine_loss: 0.6231 - kl_div: 1.0352 11/105 [==>...........................] - ETA: 28s - loss: 23.3388 - mse: 0.0034 - cosine_loss: 0.6220 - kl_div: 1.0355 12/105 [==>...........................] - ETA: 28s - loss: 23.5710 - mse: 0.0034 - cosine_loss: 0.6213 - kl_div: 1.0353 13/105 [==>...........................] - ETA: 28s - loss: 23.5045 - mse: 0.0034 - cosine_loss: 0.6208 - kl_div: 1.0351 14/105 [===>..........................] - ETA: 27s - loss: 23.4857 - mse: 0.0034 - cosine_loss: 0.6202 - kl_div: 1.0348 15/105 [===>..........................] - ETA: 27s - loss: 23.3779 - mse: 0.0034 - cosine_loss: 0.6194 - kl_div: 1.0346 16/105 [===>..........................] - ETA: 27s - loss: 23.3097 - mse: 0.0034 - cosine_loss: 0.6187 - kl_div: 1.0348 17/105 [===>..........................] - ETA: 26s - loss: 23.3341 - mse: 0.0034 - cosine_loss: 0.6180 - kl_div: 1.0352 18/105 [====>.........................] - ETA: 26s - loss: 23.3253 - mse: 0.0034 - cosine_loss: 0.6173 - kl_div: 1.0354 19/105 [====>.........................] - ETA: 26s - loss: 23.3790 - mse: 0.0034 - cosine_loss: 0.6164 - kl_div: 1.0356 20/105 [====>.........................] - ETA: 26s - loss: 23.4500 - mse: 0.0034 - cosine_loss: 0.6157 - kl_div: 1.0357 21/105 [=====>........................] - ETA: 25s - loss: 23.5549 - mse: 0.0034 - cosine_loss: 0.6148 - kl_div: 1.0359 22/105 [=====>........................] - ETA: 25s - loss: 23.5600 - mse: 0.0034 - cosine_loss: 0.6144 - kl_div: 1.0365 23/105 [=====>........................] - ETA: 25s - loss: 23.5524 - mse: 0.0034 - cosine_loss: 0.6136 - kl_div: 1.0370 24/105 [=====>........................] - ETA: 24s - loss: 23.4498 - mse: 0.0034 - cosine_loss: 0.6132 - kl_div: 1.0372 25/105 [======>.......................] - ETA: 24s - loss: 23.5624 - mse: 0.0034 - cosine_loss: 0.6120 - kl_div: 1.0375 26/105 [======>.......................] - ETA: 24s - loss: 23.4823 - mse: 0.0034 - cosine_loss: 0.6116 - kl_div: 1.0377 27/105 [======>.......................] - ETA: 23s - loss: 23.5295 - mse: 0.0034 - cosine_loss: 0.6105 - kl_div: 1.0383 28/105 [=======>......................] - ETA: 23s - loss: 23.3490 - mse: 0.0034 - cosine_loss: 0.6105 - kl_div: 1.0385 29/105 [=======>......................] - ETA: 23s - loss: 23.2919 - mse: 0.0033 - cosine_loss: 0.6093 - kl_div: 1.0390 30/105 [=======>......................] - ETA: 22s - loss: 23.1954 - mse: 0.0033 - cosine_loss: 0.6091 - kl_div: 1.0392 31/105 [=======>......................] - ETA: 22s - loss: 23.1757 - mse: 0.0033 - cosine_loss: 0.6078 - kl_div: 1.0396 32/105 [========>.....................] - ETA: 22s - loss: 23.1807 - mse: 0.0033 - cosine_loss: 0.6074 - kl_div: 1.0401 33/105 [========>.....................] - ETA: 22s - loss: 23.1296 - mse: 0.0033 - cosine_loss: 0.6066 - kl_div: 1.0406 34/105 [========>.....................] - ETA: 21s - loss: 23.1064 - mse: 0.0033 - cosine_loss: 0.6061 - kl_div: 1.0410 35/105 [=========>....................] - ETA: 21s - loss: 23.0879 - mse: 0.0033 - cosine_loss: 0.6052 - kl_div: 1.0415 36/105 [=========>....................] - ETA: 21s - loss: 23.1425 - mse: 0.0033 - cosine_loss: 0.6047 - kl_div: 1.0419 37/105 [=========>....................] - ETA: 20s - loss: 23.1264 - mse: 0.0033 - cosine_loss: 0.6039 - kl_div: 1.0425 38/105 [=========>....................] - ETA: 20s - loss: 23.0738 - mse: 0.0033 - cosine_loss: 0.6033 - kl_div: 1.0429 39/105 [==========>...................] - ETA: 20s - loss: 23.0842 - mse: 0.0033 - cosine_loss: 0.6024 - kl_div: 1.0433 40/105 [==========>...................] - ETA: 19s - loss: 23.0341 - mse: 0.0033 - cosine_loss: 0.6017 - kl_div: 1.0437 41/105 [==========>...................] - ETA: 19s - loss: 22.9349 - mse: 0.0033 - cosine_loss: 0.6010 - kl_div: 1.0442 42/105 [===========>..................] - ETA: 19s - loss: 22.9273 - mse: 0.0033 - cosine_loss: 0.6003 - kl_div: 1.0446 43/105 [===========>..................] - ETA: 19s - loss: 22.8561 - mse: 0.0033 - cosine_loss: 0.5996 - kl_div: 1.0451 44/105 [===========>..................] - ETA: 18s - loss: 22.8201 - mse: 0.0033 - cosine_loss: 0.5990 - kl_div: 1.0456 45/105 [===========>..................] - ETA: 18s - loss: 22.7568 - mse: 0.0033 - cosine_loss: 0.5984 - kl_div: 1.0461 46/105 [============>.................] - ETA: 18s - loss: 22.7275 - mse: 0.0033 - cosine_loss: 0.5976 - kl_div: 1.0466 47/105 [============>.................] - ETA: 17s - loss: 22.6965 - mse: 0.0033 - cosine_loss: 0.5969 - kl_div: 1.0470 48/105 [============>.................] - ETA: 17s - loss: 22.6547 - mse: 0.0033 - cosine_loss: 0.5964 - kl_div: 1.0475 49/105 [=============>................] - ETA: 17s - loss: 22.6393 - mse: 0.0033 - cosine_loss: 0.5956 - kl_div: 1.0479 50/105 [=============>................] - ETA: 16s - loss: 22.5859 - mse: 0.0033 - cosine_loss: 0.5949 - kl_div: 1.0483 51/105 [=============>................] - ETA: 16s - loss: 22.5205 - mse: 0.0032 - cosine_loss: 0.5945 - kl_div: 1.0488 52/105 [=============>................] - ETA: 16s - loss: 22.4651 - mse: 0.0032 - cosine_loss: 0.5938 - kl_div: 1.0492 53/105 [==============>...............] - ETA: 15s - loss: 22.4259 - mse: 0.0032 - cosine_loss: 0.5933 - kl_div: 1.0496 54/105 [==============>...............] - ETA: 15s - loss: 22.4080 - mse: 0.0032 - cosine_loss: 0.5925 - kl_div: 1.0501 55/105 [==============>...............] - ETA: 15s - loss: 22.3803 - mse: 0.0032 - cosine_loss: 0.5919 - kl_div: 1.0505 56/105 [===============>..............] - ETA: 14s - loss: 22.3225 - mse: 0.0032 - cosine_loss: 0.5911 - kl_div: 1.0509 57/105 [===============>..............] - ETA: 14s - loss: 22.3036 - mse: 0.0032 - cosine_loss: 0.5904 - kl_div: 1.0514 58/105 [===============>..............] - ETA: 14s - loss: 22.3056 - mse: 0.0032 - cosine_loss: 0.5896 - kl_div: 1.0519 59/105 [===============>..............] - ETA: 14s - loss: 22.2629 - mse: 0.0032 - cosine_loss: 0.5891 - kl_div: 1.0523 60/105 [================>.............] - ETA: 13s - loss: 22.2519 - mse: 0.0032 - cosine_loss: 0.5882 - kl_div: 1.0527 61/105 [================>.............] - ETA: 13s - loss: 22.2451 - mse: 0.0032 - cosine_loss: 0.5878 - kl_div: 1.0532 62/105 [================>.............] - ETA: 13s - loss: 22.2075 - mse: 0.0032 - cosine_loss: 0.5872 - kl_div: 1.0536 63/105 [=================>............] - ETA: 12s - loss: 22.1801 - mse: 0.0032 - cosine_loss: 0.5867 - kl_div: 1.0540 64/105 [=================>............] - ETA: 12s - loss: 22.1683 - mse: 0.0032 - cosine_loss: 0.5860 - kl_div: 1.0545 65/105 [=================>............] - ETA: 12s - loss: 22.1540 - mse: 0.0032 - cosine_loss: 0.5856 - kl_div: 1.0550 66/105 [=================>............] - ETA: 11s - loss: 22.1107 - mse: 0.0032 - cosine_loss: 0.5847 - kl_div: 1.0555 67/105 [==================>...........] - ETA: 11s - loss: 22.0987 - mse: 0.0032 - cosine_loss: 0.5843 - kl_div: 1.0559 68/105 [==================>...........] - ETA: 11s - loss: 22.0611 - mse: 0.0032 - cosine_loss: 0.5836 - kl_div: 1.0563 69/105 [==================>...........] - ETA: 10s - loss: 22.0603 - mse: 0.0032 - cosine_loss: 0.5831 - kl_div: 1.0568 70/105 [===================>..........] - ETA: 10s - loss: 22.0495 - mse: 0.0032 - cosine_loss: 0.5824 - kl_div: 1.0572 71/105 [===================>..........] - ETA: 10s - loss: 22.0268 - mse: 0.0032 - cosine_loss: 0.5819 - kl_div: 1.0577 72/105 [===================>..........] - ETA: 10s - loss: 22.0391 - mse: 0.0032 - cosine_loss: 0.5812 - kl_div: 1.0583 73/105 [===================>..........] - ETA: 9s - loss: 22.0168 - mse: 0.0032 - cosine_loss: 0.5806 - kl_div: 1.0587  74/105 [====================>.........] - ETA: 9s - loss: 21.9980 - mse: 0.0032 - cosine_loss: 0.5799 - kl_div: 1.0591 75/105 [====================>.........] - ETA: 9s - loss: 21.9798 - mse: 0.0032 - cosine_loss: 0.5793 - kl_div: 1.0596 76/105 [====================>.........] - ETA: 8s - loss: 21.9731 - mse: 0.0032 - cosine_loss: 0.5786 - kl_div: 1.0601 77/105 [=====================>........] - ETA: 8s - loss: 21.9716 - mse: 0.0032 - cosine_loss: 0.5780 - kl_div: 1.0606 78/105 [=====================>........] - ETA: 8s - loss: 21.9539 - mse: 0.0032 - cosine_loss: 0.5773 - kl_div: 1.0610 79/105 [=====================>........] - ETA: 7s - loss: 21.9541 - mse: 0.0032 - cosine_loss: 0.5767 - kl_div: 1.0615 80/105 [=====================>........] - ETA: 7s - loss: 21.9363 - mse: 0.0032 - cosine_loss: 0.5760 - kl_div: 1.0619 81/105 [======================>.......] - ETA: 7s - loss: 21.9353 - mse: 0.0032 - cosine_loss: 0.5754 - kl_div: 1.0624 82/105 [======================>.......] - ETA: 7s - loss: 21.9065 - mse: 0.0031 - cosine_loss: 0.5747 - kl_div: 1.0628 83/105 [======================>.......] - ETA: 6s - loss: 21.8823 - mse: 0.0031 - cosine_loss: 0.5741 - kl_div: 1.0633 84/105 [=======================>......] - ETA: 6s - loss: 21.8870 - mse: 0.0031 - cosine_loss: 0.5734 - kl_div: 1.0637 85/105 [=======================>......] - ETA: 6s - loss: 21.8874 - mse: 0.0031 - cosine_loss: 0.5728 - kl_div: 1.0642 86/105 [=======================>......] - ETA: 5s - loss: 21.8584 - mse: 0.0031 - cosine_loss: 0.5722 - kl_div: 1.0646 87/105 [=======================>......] - ETA: 5s - loss: 21.8401 - mse: 0.0031 - cosine_loss: 0.5716 - kl_div: 1.0651 88/105 [========================>.....] - ETA: 5s - loss: 21.8077 - mse: 0.0031 - cosine_loss: 0.5709 - kl_div: 1.0655 89/105 [========================>.....] - ETA: 4s - loss: 21.7574 - mse: 0.0031 - cosine_loss: 0.5704 - kl_div: 1.0659 90/105 [========================>.....] - ETA: 4s - loss: 21.7368 - mse: 0.0031 - cosine_loss: 0.5696 - kl_div: 1.0663 91/105 [=========================>....] - ETA: 4s - loss: 21.7271 - mse: 0.0031 - cosine_loss: 0.5691 - kl_div: 1.0669 92/105 [=========================>....] - ETA: 3s - loss: 21.7202 - mse: 0.0031 - cosine_loss: 0.5684 - kl_div: 1.0673 93/105 [=========================>....] - ETA: 3s - loss: 21.7216 - mse: 0.0031 - cosine_loss: 0.5679 - kl_div: 1.0678 94/105 [=========================>....] - ETA: 3s - loss: 21.7130 - mse: 0.0031 - cosine_loss: 0.5671 - kl_div: 1.0682 95/105 [==========================>...] - ETA: 3s - loss: 21.6958 - mse: 0.0031 - cosine_loss: 0.5668 - kl_div: 1.0687 96/105 [==========================>...] - ETA: 2s - loss: 21.6563 - mse: 0.0031 - cosine_loss: 0.5659 - kl_div: 1.0691 97/105 [==========================>...] - ETA: 2s - loss: 21.6473 - mse: 0.0031 - cosine_loss: 0.5656 - kl_div: 1.0695 98/105 [===========================>..] - ETA: 2s - loss: 21.6101 - mse: 0.0031 - cosine_loss: 0.5647 - kl_div: 1.0699 99/105 [===========================>..] - ETA: 1s - loss: 21.5815 - mse: 0.0031 - cosine_loss: 0.5644 - kl_div: 1.0703100/105 [===========================>..] - ETA: 1s - loss: 21.5621 - mse: 0.0031 - cosine_loss: 0.5637 - kl_div: 1.0707101/105 [===========================>..] - ETA: 1s - loss: 21.5476 - mse: 0.0031 - cosine_loss: 0.5633 - kl_div: 1.0711102/105 [============================>.] - ETA: 0s - loss: 21.5248 - mse: 0.0031 - cosine_loss: 0.5626 - kl_div: 1.0715103/105 [============================>.] - ETA: 0s - loss: 21.5029 - mse: 0.0031 - cosine_loss: 0.5621 - kl_div: 1.0718104/105 [============================>.] - ETA: 0s - loss: 21.4757 - mse: 0.0031 - cosine_loss: 0.5615 - kl_div: 1.0722105/105 [==============================] - ETA: 0s - loss: 21.4544 - mse: 0.0031 - cosine_loss: 0.5609 - kl_div: 1.0726 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s13/36 [=========>....................] - ETA: 0s25/36 [===================>..........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s26/36 [====================>.........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
 1/36 [..............................] - ETA: 0s14/36 [==========>...................] - ETA: 0s27/36 [=====================>........] - ETA: 0s36/36 [==============================] - 0s 4ms/step
2023-05-03 21:30:42.013118: W tensorflow/tsl/framework/cpu_allocator_impl.cc:82] Allocation of 6457589760 exceeds 10% of free system memory.
2023-05-03 21:30:49.759581: W tensorflow/tsl/framework/cpu_allocator_impl.cc:82] Allocation of 6457589760 exceeds 10% of free system memory.
Model metrics:Recall@5=0.2232 Recall@20=0.2636 custom_Recall@20=0.2339 Recall@50=0.372 custom_Recall@50=0.3667 NCDG@100=0.3057 custom_NCDG@100=0.3057 Coverage@5=0.1102 Coverage@20=0.1804 Coverage@50=0.2421 Coverage@100=0.2912 
105/105 [==============================] - 81s 778ms/step - loss: 21.4544 - mse: 0.0031 - cosine_loss: 0.5609 - kl_div: 1.0726 - val_loss: 17.8047 - val_mse: 0.0027 - val_cosine_loss: 0.4704 - val_kl_div: 0.0000e+00
